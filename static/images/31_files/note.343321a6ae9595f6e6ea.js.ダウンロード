(window.webpackJsonp=window.webpackJsonp||[]).push([[405],{3703:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));n(11),n(12);var r=n(381),o=e=>{var t=[],n=(e=>e.membershipMagazines)(e);if(!n)return t;for(var r of n)t.push({type:"magazine",text:"".concat(r.name)});return t},l=(e,t)=>{var n=[];return e.membershipNotesEnabled&&n.push({type:"note",text:"メンバー限定の記事"}),!1===Object(r.a)(e.circle,t)&&e.isBoardEnabled&&n.unshift({type:"circle",text:"メンバー限定の掲示板"}),e.membershipMagazinesEnabled&&n.push({type:"magazine",text:"メンバー特典マガジン"}),n.push({type:"memberscard",text:"メンバー限定の会員証"}),0!==e.price&&n.push({type:"badge",text:"活動期間に応じたバッジ"}),n},c=(e,t)=>{var n=(e=>e.benefitAppealTexts.map((text=>({type:"gift",text:text}))))(e);return[...n,...o(e),...l(e,t)]},d=e=>{var t=[];!1===Object(r.a)(e.circle,!1)&&t.push({type:"circle",text:"メンバー限定掲示板"});var n=e.membershipNoteCount;e.membershipNotesEnabled&&n>0&&t.push({type:"note",text:"".concat(n,"個のメンバー限定の記事")});var o=e.membershipMagazines.length;return e.membershipMagazinesEnabled&&o>0&&t.push({type:"magazine",text:"".concat(o,"個のメンバー特典マガジン")}),t.push({type:"memberscard",text:"メンバー限定の会員証"}),0!==e.price&&t.push({type:"badge",text:"活動期間に応じたバッジ"}),e.benefitAppealTexts.length>0&&t.push({type:"gift",text:"その他".concat(e.benefitAppealTexts.length,"個の特典")}),t}},3739:function(e,t,n){var content=n(4106);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(16).default)("1a51e8fa",content,!0,{sourceMap:!1})},3740:function(e,t,n){var content=n(4108);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(16).default)("40300f76",content,!0,{sourceMap:!1})},3927:function(e,t,n){"use strict";var r=n(1),o=n(248),l=r.a.extend({components:{NtSvgIcon:o.default},props:{benefitAppealTexts:{type:Array,required:!0},iconType:{type:String,default:"recommend"},size:{type:String,default:"medium"}},computed:{appealTexts(){return this.benefitAppealTexts.map((e=>void 0===(null==e?void 0:e.type)?{type:this.iconType,text:e}:e))},benefitListStyle(){return"small"===this.size?"gap-[0.125rem]":"gap-2"},benefitListItemStyle(){return"small"===this.size?"text-xs":"text-sm font-bold"}}}),c=n(7),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{class:"m-BenefitAppealTexts flex flex-col "+e.benefitListStyle,attrs:{"aria-label":"特典一覧"}},e._l(e.appealTexts,(function(t,i){return n("li",{key:i,class:"flex items-start break-all "+e.benefitListItemStyle},[n("div",{staticClass:"mr-2 flex items-center justify-center"},[n("nt-svg-icon",{attrs:{"aria-hidden":"true",type:t.type}})],1),e._v(" "),n("span",{staticClass:"self-center"},[e._v("\n      "+e._s(t.text)+"\n    ")])])})),0)}),[],!1,null,null,null);t.a=component.exports},3962:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(23);const o=Object(r.a)((()=>"/v3/memberships/subscription_withdrawal_preset_reasons"),(async(e,s,a,t)=>(await e.get(s,t)).data.data))},3963:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(23);const p=Object(r.a)((e=>`/v2/subscriptions/circle_plans/${e}`),(async(e,s,a,t)=>(await e.delete(s,t)).data.data))},3964:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(23),o=n(34);const p=Object(r.a)((e=>`/v3/memberships/plans/${e}/withdrawal_reasons`),(async(e,s,t,a)=>{if(void 0===t)throw new Error("requestParams is required");await e.post(s,Object(o.b)(t),a)}))},4105:function(e,t,n){"use strict";n(3739)},4106:function(e,t,n){var r=n(15)((function(i){return i[1]}));r.push([e.i,".m-basicModalContent[data-v-bfc4b004]{position:relative;margin:56px auto;background:var(--color-surface-normal);border-radius:8px}@media only screen and (max-width:480px){.m-basicModalContent[data-v-bfc4b004]{margin:8px auto 80px}}.m-basicModalContent__header[data-v-bfc4b004]:not(:empty){padding:16px;font-size:var(--font-size-base);color:var(--color-text-primary);text-align:center;border-bottom:1px solid var(--color-border-default)}@media only screen and (max-width:480px){.m-basicModalContent__body[data-v-bfc4b004]{width:100%}}.m-basicModalContent__body--height[data-v-bfc4b004]{max-height:440px}@media only screen and (max-width:480px){.m-basicModalContent__body--height[data-v-bfc4b004]{height:calc(100vh - 240px)}}.m-basicModalContent__body--scrollable[data-v-bfc4b004]{max-height:440px;overflow-y:auto}@media only screen and (max-width:480px){.m-basicModalContent__body--scrollable[data-v-bfc4b004]{max-height:calc(100vh - 240px)}}.m-basicModalContent__footer[data-v-bfc4b004]{display:flex;align-items:center;justify-content:center;padding:16px;background-color:var(--color-background-secondary);border-top:1px solid var(--color-border-default);border-radius:0 0 .5rem .5rem}.m-basicModalContent--size_small[data-v-bfc4b004]{width:470px}@media only screen and (max-width:480px){.m-basicModalContent--size_small[data-v-bfc4b004]{width:calc(100% - 16px)}}.m-basicModalContent--size_medium[data-v-bfc4b004]{width:580px}@media only screen and (max-width:480px){.m-basicModalContent--size_medium[data-v-bfc4b004]{width:calc(100% - 16px)}}.m-basicModalContent--size_large[data-v-bfc4b004]{width:100%}@media only screen and (max-width:480px){.m-basicModalContent--size_large[data-v-bfc4b004]{width:calc(100% - 16px)}}",""]),r.locals={},e.exports=r},4107:function(e,t,n){"use strict";n(3740)},4108:function(e,t,n){var r=n(15)((function(i){return i[1]}));r.push([e.i,".m-unsubscribeMembershipModal[data-v-bfc4b004]{overflow:hidden;border:1px solid var(--color-border-default);border-radius:8px}.m-unsubscribeMembershipModal__title[data-v-bfc4b004]{font-weight:600}.m-unsubscribeMembershipModal__body[data-v-bfc4b004]{padding:32px;font-size:var(--font-size-base)}@media only screen and (max-width:480px){.m-unsubscribeMembershipModal__body[data-v-bfc4b004]{padding:24px}}.m-unsubscribeMembershipModal__card[data-v-bfc4b004]{position:relative;overflow:hidden;border-radius:4%/7.1%;box-shadow:var(--elevation-4)}.m-unsubscribeMembershipModal__cardInner[data-v-bfc4b004]{position:relative;height:0;padding-bottom:56.25%}.m-unsubscribeMembershipModal__cardImg[data-v-bfc4b004]{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;height:100%;background:var(--color-gray-500);object-fit:cover}",""]),r.locals={},e.exports=r},4372:function(e,t,n){"use strict";var r=n(0),o=(n(139),n(30),n(26),n(612),n(11),n(12),n(1)),l=n(193),c=n(43),d=n(37),m=n(250),f=n(155),h=n(3962),v=n(3963),x=n(3964),_=n(21),y=n.n(_),C=n(24),M=n(194),w=n(251),S=n(69),k=n(192),I=n(376),z=n(3927),j=n(3703),O=o.a.extend({components:{NtButton:c.a,NtImage:d.default,ModalFooterButtonGroup:m.a,ModalHeading:f.a,FormCheckbox:M.a,FormTextarea:w.a,Avatar:k.default,BenefitAppealTexts:z.a},mixins:[l.a],props:{isModal:{type:Boolean,default:!1},plan:{type:Object,required:!0},owner:{type:Object,required:!0}},data:()=>({isSubmitting:!1,isCompleted:!1,isSentSurvey:!1,cancelMessage:"",ownerMessage:"",presetReasons:[],reason:"",answerIds:[]}),computed:{title(){return"".concat(this.plan.name,"を解約する")},message(){return"".concat(this.plan.description)},hasBenefits(){return this.plan.benefitAppealTexts.length>0},visibleSurvey(){return"normal"===this.plan.kind&&this.plan.price>0},profileImage(){return new I.a(this.owner.userProfileImagePath).size(32).dpr().crop("1:1,smart").toString()},benefitAppealTexts(){return Object(j.b)(this.plan)}},methods:{init(){var e=this;return Object(r.a)((function*(){e.isSubmitting=!1,e.isCompleted=!1,e.isSentSurvey=!1,e.cancelMessage="";var t=yield h.a.call(y.a,void 0,void 0,Object(C.a)(e)).finally((()=>[])),n=t.find((e=>"その他"===e.reason)),r=(e=>{for(var t,n=e.length;0!=n;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e})(t.filter((e=>"その他"!==e.reason)));e.presetReasons=n?[...r,n]:r}))()},postUnsubscribe(){var e=this;return Object(r.a)((function*(){var t;e.isSubmitting=!0;var n=e.plan.key;try{var r=yield v.a.call(y.a,[n],void 0,Object(C.a)(e));e.setIsCompleted(!0),e.cancelMessage=r.cancelMessage,e.ownerMessage=null!==(t=r.withdrawalMessage)&&void 0!==t?t:""}catch(t){var o=e.toApiErrorMessage(t.response);Object(S.H)(e,{message:o})}e.isSubmitting=!1}))()},setIsCompleted(e){this.isCompleted=e,this.$emit("update-is-completed",{bool:e})},handleClickClose(){this.$emit("click-close")},setAnswerIds(e,t){this.answerIds=e?[...this.answerIds,t]:this.answerIds.filter((e=>e!==t))},postSurvey(){var e=this;return Object(r.a)((function*(){e.isSubmitting=!0;try{if(""===e.reason&&0===e.answerIds.length)return;yield x.a.call(y.a,[e.plan.key],{reason:e.reason,answerIds:e.answerIds},Object(C.a)(e)),e.isSentSurvey=!0}catch(e){}finally{e.isSubmitting=!1,e.handleClickClose()}}))()}}}),P=(n(4105),n(4107),n(7)),component=Object(P.a)(O,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"m-unsubscribeMembershipModal",class:{"mt-6":!e.isModal}},[n("div",{staticClass:"m-basicModalContent__header"},[n("div",{staticClass:"m-unsubscribeMembershipModal__title"},[e.isModal?n("modal-heading",{staticClass:"inline"},[e._v("\n        "+e._s(e.title)+"\n      ")]):[e._v("\n        "+e._s(e.title)+"\n      ")]],2)]),e._v(" "),n("section",{staticClass:"m-unsubscribeMembershipModal__body"},[n("div",{staticClass:"flex gap-4 mb-6 items-start"},[e.plan.headerImagePath?n("div",{staticClass:"m-unsubscribeMembershipModal__card w-[6rem]"},[n("div",{staticClass:"m-unsubscribeMembershipModal__cardInner"},[n("nt-image",{staticClass:"m-unsubscribeMembershipModal__cardImg",attrs:{src:e.plan.headerImagePath,alt:""}})],1)]):e._e(),e._v(" "),n("div",{staticClass:"flex-1"},[n("h3",{staticClass:"mb-2 font-bold"},[e._v("\n          "+e._s(e.plan.name)+"\n        ")]),e._v(" "),n("p",{staticClass:"text-sm"},[e._v("\n          "+e._s(e.plan.description)+"\n        ")])])]),e._v(" "),e.isCompleted?n("div",[n("p",{staticClass:"text-sm text-center whitespace-pre-line",domProps:{textContent:e._s(e.cancelMessage)}}),e._v(" "),""!==e.ownerMessage?n("dl",[n("dt",{staticClass:"text-sm font-bold mt-4 mb-2"},[e._v("\n          クリエイターからのメッセージ\n        ")]),e._v(" "),n("dd",{staticClass:"flex gap-2"},[n("avatar",{staticClass:"w-8 h-8 flex-shrink-0",attrs:{src:e.profileImage,size:"fit",alt:""}}),e._v(" "),n("span",{staticClass:"flex p-2 text-sm whitespace-pre-line rounded-lg leading-6 border border-border-default",domProps:{textContent:e._s(e.ownerMessage)}})],1)]):e._e(),e._v(" "),e.visibleSurvey?n("div",[e._m(0),e._v(" "),n("small",{staticClass:"block text-xs text-text-secondary mb-4"},[e._v("\n          ※回答は統計処理のうえ、クリエイターに提供することがあります。\n        ")]),e._v(" "),e.isSentSurvey?[n("p",{staticClass:"text-sm text-center"},[e._v("\n            回答ありがとうございました。\n          ")])]:[e.presetReasons.length>0?n("div",e._l(e.presetReasons,(function(t){return n("div",{key:t.id},[n("form-checkbox",{staticClass:"mb-2",attrs:{id:"reason"+t.id,checked:e.answerIds.includes(t.id),value:!0,label:t.reason},on:{input:function(n){return e.setAnswerIds(n,t.id)}}})],1)})),0):e._e(),e._v(" "),n("form-textarea",{staticClass:"mt-4",attrs:{id:"reason",placeholder:"ご自由に意見を記入してください。"},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}})]],2):e._e()]):[n("div",[n("p",{staticClass:"text-sm font-bold mb-4"},[e._v("\n          解約すると、翌月から以下の特典が利用できなくなります。\n        ")]),e._v(" "),n("div",{staticClass:"p-4 border border-border-default rounded-lg"},[n("benefit-appeal-texts",{attrs:{"benefit-appeal-texts":e.benefitAppealTexts}})],1)])]],2),e._v(" "),n("div",{staticClass:"m-basicModalContent__footer"},[n("modal-footer-button-group",{scopedSlots:e._u([{key:"default",fn:function(t){return[e.isCompleted?[n("nt-button",{class:t.buttonClass,attrs:{type:"basic",size:"small"},on:{click:function(t){return t.preventDefault(),e.handleClickClose(t)}}},[e._v("\n          閉じる\n        ")]),e._v(" "),!0===e.visibleSurvey?n("nt-button",{class:t.buttonClass,attrs:{type:e.isSubmitting||e.isSentSurvey?"disabled":"primary",disabled:e.isSubmitting||e.isSentSurvey,size:"small"},on:{click:function(t){return t.preventDefault(),e.postSurvey(t)}}},[e._v("\n          "+e._s(e.isSubmitting?"処理中":"回答する")+"\n        ")]):e._e()]:[n("nt-button",{class:t.buttonClass,attrs:{type:"basic",size:"small"},on:{click:function(t){return t.preventDefault(),e.handleClickClose(t)}}},[e._v("\n          キャンセル\n        ")]),e._v(" "),!1===e.isCompleted?n("nt-button",{class:t.buttonClass,attrs:{type:e.isSubmitting?"disabled":"danger",disabled:e.isSubmitting,size:"small"},on:{click:function(t){return t.preventDefault(),e.postUnsubscribe(t)}}},[e._v("\n          "+e._s(e.isSubmitting?"処理中":"解約する")+"\n        ")]):e._e()]]}}])})],1)])}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",{staticClass:"text-sm font-bold mt-10"},[e._v("\n          noteをもっとよくするため解約理由をご記入ください\n          "),n("span",{staticClass:"text-text-secondary"},[e._v("（任意）")])])}],!1,null,"bfc4b004",null);t.a=component.exports},6807:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(54),l=n(82),c=n(73),d=n(4372),m=r.a.extend({components:{BasicModalContent:l.a,NtModal:c.a,UnsubscribeMembershipPlanShared:d.a},mixins:[o.a],data:()=>({isCompleted:!1}),computed:{plan(){return this.$store.state.modal.unsubscribeMembershipPlan.plan},owner(){return this.$store.state.modal.unsubscribeMembershipPlan.owner},unsubscribeCallback(){return this.$store.state.modal.unsubscribeMembershipPlan.unsubscribeCallback}},methods:{init(){var e;this.isCompleted=!1,null===(e=this.$refs.unsubscribeMembershipPlanShared)||void 0===e||e.init()},onClose(){!0===this.isCompleted&&this.unsubscribeCallback&&this.unsubscribeCallback()},setIsCompleted(e){var{bool:t}=e;this.isCompleted=t}}}),f=n(7),component=Object(f.a)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.plan?n("nt-modal",{attrs:{"disable-backdrop":!1,name:"unsubscribeMembershipPlan"},on:{"before-open":e.init,"before-close":e.onClose}},[n("basic-modal-content",{staticClass:"o-unsubscribeMembershipPlanModal"},[n("unsubscribe-membership-plan-shared",{ref:"unsubscribeMembershipPlanShared",attrs:{slot:"allParts","is-modal":!0,plan:e.plan,owner:e.owner},on:{"click-close":e.popModal,"update-is-completed":e.setIsCompleted},slot:"allParts"})],1)],1):e._e()}),[],!1,null,null,null);t.default=component.exports}}]);