(window.webpackJsonp=window.webpackJsonp||[]).push([[580],{5063:function(e,t,o){var content=o(6503);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(16).default)("6eefb1d1",content,!0,{sourceMap:!1})},6502:function(e,t,o){"use strict";o(5063)},6503:function(e,t,o){var n=o(15)((function(i){return i[1]}));n.push([e.i,'.o-commentAreaCreateComment[data-v-1598d9bd]{position:relative}.o-commentAreaCreateComment__add[data-v-1598d9bd]{box-sizing:border-box;padding-top:16px;padding-bottom:16px;border-top:1px solid var(--color-border-default)}.o-commentAreaCreateComment__add.is-empty[data-v-1598d9bd]{border:none}.o-commentAreaCreateComment__add.no-border[data-v-1598d9bd]{padding-top:.5rem;border-top:none}.o-commentAreaCreateComment__input[data-v-1598d9bd]{position:relative;display:flex;justify-content:space-between;transition:padding-bottom .15s ease-in-out}.o-commentAreaCreateComment__input.is-active[data-v-1598d9bd]{padding-bottom:48px}@media only screen and (max-width:480px){.o-commentAreaCreateComment__input.is-active[data-v-1598d9bd]{padding-bottom:40px}}.o-commentAreaCreateComment__inputAvatar[data-v-1598d9bd]{flex:0 0 auto;margin-right:8px}.o-commentAreaCreateComment__inputMessage[data-v-1598d9bd]:not(:root){flex:1;height:32px;min-height:32px;margin-top:-4px;font-family:PrimaryEmojiFont,"Helvetica Neue","Hiragino Kaku Gothic ProN","Hiragino Sans","Apple Color Emoji","noto color emoji",Arial,"Segoe UI Emoji","Segoe UI Symbol",Meiryo,sans-serif;resize:none;border:1px solid transparent}.o-commentAreaCreateComment__inputAction[data-v-1598d9bd]{position:absolute;right:0;bottom:0;display:flex;margin-top:8px;opacity:0}.o-commentAreaCreateComment__inputAction.is-active[data-v-1598d9bd]{pointer-events:auto;opacity:1;transition:opacity .15s ease-in-out}.o-commentAreaCreateComment__inputAction--edit[data-v-1598d9bd]{position:static;bottom:auto;left:auto;pointer-events:auto;opacity:1}.o-commentAreaCreateComment__inputButton[data-v-1598d9bd]{width:100px}.o-commentAreaCreateComment__inputButton+.o-commentAreaCreateComment__inputButton[data-v-1598d9bd]{margin-left:8px}.o-commentAreaCreateComment__inputButton.is-disabled[data-v-1598d9bd]{pointer-events:none}.o-commentAreaCreateComment__inputError[data-v-1598d9bd]{margin-top:8px;font-size:var(--font-size-sm);color:var(--color-text-danger)}.o-commentAreaCreateComment__alertLabel[data-v-1598d9bd]{padding-top:24px;padding-bottom:24px;font-size:var(--font-size-sm);line-height:1.5;color:var(--color-text-secondary);border-top:1px solid var(--color-border-default)}.o-commentAreaCreateComment__alertLabel--noborder[data-v-1598d9bd]{border-top:none}.o-commentAreaCreateComment__alertLink[data-v-1598d9bd]{font-size:var(--font-size-sm);line-height:1.5;color:var(--color-text-secondary)}.slide-enter-active[data-v-1598d9bd],.slide-leave-active[data-v-1598d9bd]{transition:padding-top .3s ease-out,padding-bottom .3s ease-out}.slide-enter-active>*[data-v-1598d9bd]{transition:line-height .1s ease-out,opacity .1s linear .1s,visibility .1s linear .1s}.slide-leave-active>*[data-v-1598d9bd]{transition:line-height .1s ease-out,opacity .1s linear,visibility .1s linear}.slide-enter[data-v-1598d9bd],.slide-leave-to[data-v-1598d9bd]{padding-top:0;padding-bottom:0}.slide-enter>*[data-v-1598d9bd],.slide-leave-to>*[data-v-1598d9bd]{line-height:0;visibility:hidden;opacity:0}',""]),n.locals={},e.exports=n},6945:function(e,t,o){"use strict";o.r(t);var n=o(0),r=(o(159),o(88),o(30),o(1)),m=o(17),d=o(578),l=o(54),c=o(10),C=o(126),v=o(192),h=o(43),_=o(394),f=r.a.extend({components:{Avatar:v.default,NtButton:h.a,NtTextarea:_.a},mixins:[l.a],props:{note:{type:Object,required:!0},isAfterCreateCommentEventNeeded:{type:Boolean,default:!1},placeholder:{type:String,default:null},noBorder:{type:Boolean,default:!1}},data:()=>({newComment:"",isSendingNewComment:!1,showSlide:!1,drawCommentForm:!0,commentLength:0,createdCommentId:null}),computed:{showCreateComment(){return this.currentUser&&this.currentUser.urlname&&this.currentUser.emailConfirmedFlag&&this.note.commentViewable&&this.note.canComment},overMaxCommentNumMessage:()=>"コメントは".concat(c.maxNoteCommentNum,"文字以内で入力してください。"),isOverMaxCommentNum(){return this.commentLength>c.maxNoteCommentNum},isDisabledCreateCommentBtn(){return!this.$options.filters.trim(this.newComment)||this.isOverMaxCommentNum||this.isSendingNewComment},randomPlaceholderMessage(){var e=["スキで伝わらない気持ちはコメントで","よかった記事には感想を送ってみませんか","コメントは作者の励みになります"];return e[Math.floor(Math.random()*e.length)]},avatarSrc(){var e,t,o,n=(null===(e=this.currentUser)||void 0===e?void 0:e.userProfileImagePath)||(null===(t=this.currentUser)||void 0===t?void 0:t.profileImageUrl)||(null===(o=this.currentUser)||void 0===o?void 0:o.userProfileImageUrl)||"";return!n||n.startsWith("~")?n:new m.a(n).width(32).dpr(2).toString()}},watch:{newComment:{handler:Object(d.a)(function(){var e=Object(n.a)((function*(e){this.commentLength=yield Object(m.j)(e)}));return function(t){return e.apply(this,arguments)}}(),300)}},mounted(){this.showCreateComment&&this.mountModals("commentAcknowledgement")},beforeDestroy(){this.isAfterCreateCommentEventNeeded&&this.$emit("afterCreateNewComment",{commentId:this.createdCommentId})},methods:{createComment(e){var t=this;return Object(n.a)((function*(){t.isSendingNewComment=!0;try{t.$emit("before-create-new-comment",{commentLength:t.commentLength});var o=yield t.$store.dispatch(Object(C.noteDetailAction)("CREATE_COMMENT"),{comment:t.newComment,acknowledgement:e,callback:e=>{t.createdCommentId=e.id}});o.error?"comment_acknowledgement"===o.error.code?t.openCommentAcknowledgementModal():t.$emit("saveCommentError",o.error):(t.$emit("afterCreateNewComment",{commentId:o.data.comment.id}),t.showSlide=!1,t.newComment="",t.redrawCommentForm())}finally{t.isSendingNewComment=!1}}))()},onFocusCommentForm(){this.showSlide=!0,this.$emit("focus-comment-form")},onBlurCommentForm(){this.newComment||(this.showSlide=!1)},redrawCommentForm(){this.drawCommentForm=!1,this.$nextTick((()=>this.drawCommentForm=!0))},submitCreateComment(){this.createComment(!0)},openCommentAcknowledgementModal(){this.pushCommentAcknowledgementModal({submitCallback:this.submitCreateComment})},focusAndStartInput(){var e,t,o;null===(o=null===(t=null===(e=this.$refs)||void 0===e?void 0:e.inputMessageArea)||void 0===t?void 0:t.focus)||void 0===o||o.call(t)}}}),w=f,A=(o(6502),o(7)),component=Object(A.a)(w,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.showCreateComment?o("div",{staticClass:"o-commentAreaCreateComment"},[o("div",{staticClass:"o-commentAreaCreateComment__add",class:{"is-empty":e.note.comments.length<1,"no-border":e.noBorder}},[o("div",{staticClass:"o-commentAreaCreateComment__input",class:{"is-active":e.showSlide}},[o("div",{staticClass:"o-commentAreaCreateComment__inputAvatar"},[o("div",{staticClass:"c-avatar c-avatar--small"},[e.currentUser?o("avatar",{attrs:{src:e.avatarSrc,lazy:!0}}):e._e()],1)]),e._v(" "),e.drawCommentForm?o("nt-textarea",{ref:"inputMessageArea",staticClass:"o-commentAreaCreateComment__inputMessage",attrs:{value:e.newComment,"auto-height":!0,placeholder:e.placeholder||e.randomPlaceholderMessage,tabindex:"0"},on:{input:function(t){return e.newComment=t}},nativeOn:{focus:function(t){return e.onFocusCommentForm(t)},blur:function(t){return e.onBlurCommentForm(t)}}}):e._e(),e._v(" "),o("transition",{attrs:{name:"slide"}},[e.showSlide?o("div",{staticClass:"o-commentAreaCreateComment__inputAction",class:{"is-active":e.showSlide}},[o("div",{staticClass:"o-commentAreaCreateComment__inputButton"},[o("nt-button",{attrs:{disabled:e.isDisabledCreateCommentBtn,type:"primary",size:"small",width:"fit"},on:{click:function(t){return e.createComment(!1)}}},[e._v("\n              送信\n            ")])],1)]):e._e()])],1),e._v(" "),o("p",{directives:[{name:"show",rawName:"v-show",value:e.isOverMaxCommentNum,expression:"isOverMaxCommentNum"}],staticClass:"o-commentAreaCreateComment__inputError",attrs:{"aria-live":"assertive"}},[e._v("\n      "+e._s(e.overMaxCommentNumMessage)+"\n    ")])])]):e._e()}),[],!1,null,"1598d9bd",null);t.default=component.exports}}]);