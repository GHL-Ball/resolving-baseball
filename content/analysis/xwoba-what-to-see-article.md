---
title: "xwOBAと何を見るか"
date: 2024-08-27
categories: ["Season単位"]
tags: ["Batting", "xwOBA", "pwOBA", "SwSp%"]
---

打者の打撃能力を測る上で相当に優秀な指標である xwOBA。データサイトで手軽に確認でき、野球ファン大好きな上振れ下振れの話にも繋がり、なかなか人気のある指標ですが、他に一緒に見た方が良い指標はないの？といったことを考えていく記事です。

---

## xwOBAとは

xwOBAを真面目に解説するとそれだけで重くなりますので要点を説明すると、xwOBAは **play ではなく player を表すことを目的**とし、非打球要素はそのままに打球要素は打球速度、"垂直"打球角度に着目し（一応、内野安打が期待されるような打球については走力も考慮される）、それらから期待される wOBAを算出したものになります。

測定対象が play ではなく player という xwOBAの特徴として**予測力**があります。過去の結果には選手の能力以外の**ノイズ**も含まれていますので、そのノイズ（xwOBAでは相手の守備や水平角度など）を適宜取り除いた指標の方が未来の予測には有用です。

実際、xwOBAは来季の wOBA予測において FanGraphs や Baseball Savant にある打撃指標の中では最強の予測力を誇ります。それは打球要素も非打球要素も含む総合打撃指標がほとんどないところが理由でもありますが。

ただ、xwOBAの打球部分 xwOBAconも来季の wOBAconの予測力がトップクラスに高い指標です。

![翌年のwOBAconとの関係](/solving-baseball/images/74.png)

*翌年の wOBAconとの関係　Data : FanGraphs, Baseball Savant*

ノイズを多く含む wOBAconより打球速度のみを測定対象としている**Adjusted EV**（88 mph以下の打球を全て88 mphとして算出した平均打球速度）の方が、さらに打球速度以外に打球角度も考慮している xwOBAcon、Barrel%の方が予測力に優れていることが分かるかと思います。Barrel%がxwOBAconより少し優れている点については後ほど説明できるかと思います。

このように xwOBAは単体でも予測力に強みを持ちますが、じゃあ xwOBA以外に何か見るべき指標ってあるの？という話を考えていきます。

---

## 2023年のM・チャップマン

2023年、4月の最強打者M・チャップマンを覚えているでしょうか。

> **M・チャップマン　2023年3,4月成績**
> - wOBA .481（規定1位/181人）
> - xwOBA .486（規定1位/181人）
> - BABIP .485（規定1位/181人）
>
> *Data : MLB*

wOBAだけでなく xwOBAも断トツで文字通りMLB最強打者でした。

チャップマンの wOBAに近い例ではG・ペルドモがいました。彼の去年の初動とその後はまさにMLBファンが xwOBAを気にする理由でしょう。

> **G・ペルドモ　2023年3, 4月 vs 5月以降成績**
> - wOBA .456 ➡ wOBA .297
> - xwOBA .301 ➡ xwOBA .271
> - BABIP .477 ➡ BABIP .265
>
> *Data : MLB*

対して xwOBAと wOBAに開きのなかったチャップマンはこちらです。

> **M・チャップマン　2023年3, 4月 vs 5月以降成績**
> - wOBA .481（規定1位/181人） ➡ wOBA .291（規定127位/132人）
> - xwOBA .486（規定1位/181人） ➡ xwOBA .301（規定120位/132人）
> - BABIP .485（規定1位/181人） ➡ BABIP .276（規定111位/132人）
>
> *Data : MLB*

ただの一例なので "そういうこともある" でスルーする方がむしろ健全ではありますが、維持することのできない高BABIPとともに最強打者なら維持できる xwOBAを 3, 4月に記録し、その後見るも無惨に xwOBAも維持できなかったチャップマンの例は個人的に印象に残りました。

---

## BABIPを見ることの価値

xwOBAがある現代では打者BABIPは打者の色づけ程度の利用価値となっていますが、去年のM・チャップマンの印象に引っ張られて、xwOBAだけでなくBABIPも見ることで wOBAの予測力は上がるのかを調べてみます。

まずは 2020〜2024 年の期間に 300 打席以上立った打者を対象に、来シーズンの wOBAを目的変数にxwOBAを説明変数にして単回帰分析を行います。結果は以下。（以降 2024年は 8/20 時点のデータです）

> **係数 [p値]：** xwOBA 0.573 [2e-16]
> **切片 [p値]：** 0.133 [2e-16]
> **自由度調整済み決定係数：** 0.2863
>
> wOBA(n + 1) = 0.573 × xwOBA(n) + 0.133
>
> **標準誤差：** 0.03122
> **F統計量：** 215.3　p値 2.2e-16

予測力自体の限界はあれど非常に統計的に有意な回帰式が得られます。

では説明変数にBABIPを含めてみます。

> **係数 [p値]：** xwOBA 0.582 [2e-16]　BABIP -0.038 [0.331]
> **切片 [p値]：** 0.142 [2e-16]
> **自由度調整済み決定係数：** 0.2863
>
> wOBA(n + 1) = 0.582 × xwOBA(n) − 0.038 × BABIP(n) + 0.142
>
> **標準誤差：** 0.03122
> **F統計量：** 108.1　p値 2.2e-16

特に説明力に変化は見られません。BABIPの p値も 0.331と wOBA予測において xwOBAと合わせてBABIPを見る実用性はないと言っていいでしょう。ただ打者のBABIPは投手のBABIPより適正値の分散が大きいという特徴があります。イチローの .300は下振れだけど、アロンソの .300は上振れだよねという話です。

ということで少々雑ですが当該シーズン以前のキャリア平均との比較をしたBABIP diff. を説明変数に設定してみます。

> **係数 [p値]：** xwOBA 0.580 [2e-16]　BABIP diff. -0.075 [0.035]
> **切片 [p値]：** 0.131 [2e-16]
> **自由度調整済み決定係数：** 0.2910
>
> wOBA(n + 1) = 0.580 × xwOBA(n) − 0.075 × BABIP diff.(n) + 0.131
>
> **標準誤差：** 0.03112
> **F統計量：** 110.6　p値 2.2e-16

補正R²（自由度調整済み決定係数）は 0.2863から 0.2910と多少ですが説明力は上昇しました。BABIP diff.のp値も0.035と統計的有意性を認められる数字となりました。

ただこの程度ならキャリアBABIPとの比較をするといった簡便な行為さえも必要ないかなというのが個人的に思うところではあります。

チャップマンは打球速度の速さを補えないほどにフライヒッターかつ内野フライ率も高い低BABIPヒッターなので、BABIP .485はなおさらに異常値ではありました。

大した成果も得られなかったことなので、次は逆算する形で wOBAの予測においての xwOBAについて考えていきます。

---

## Predictive wOBA

xwOBAは play よりも player を測ることに注視した指標ですが、あくまでもその試合での価値に紐付いています。違う見方をすれば再現性を細部までは考慮されていません。xwOBAは相対的には十分 Predictive ではあると思いますが、「打球速度 80mph、打球角度 20度の打球は wOBA .850が期待される」というのは理論的には Expected です。

この点に触れたのが以下の記事です。打球速度と角度を利用するというポイントは xwOBAと揃えて、その係数を "期待される" wOBA Valueではなく "予想される" wOBA Valueに置き換えることで予測力を高めています。

- [Introducing Predictive wOBA](http://tangotiger.com/index.php/site/comments/introducing-predictive-woba) - Tangotiger Blog

詳細な算出方法は記されていませんが、ある程度は分かるので自分も算出してみました。

1. 打球速度、打球角度で打球をラベリングする（今回は12ビン）
2. 来季の wOBAconを目的変数に今季の12ビンを説明変数に切片を0に設定し重回帰分析によって係数を求める

では、Expected wOBA Value（xwOBAの算出に使われている係数）とPredictive wOBA Valueの比較をしてみましょう。

| 打球角度＼打球速度 | 〜95 | 95〜100 | 100〜105 | 105〜 |
|:---:|:---:|:---:|:---:|:---:|
| 32〜 | .063 | .203 | .668 | 1.420 |
| 8〜32 | .482 | .613 | .935 | 1.219 |
| 〜8 | .182 | .319 | .383 | .452 |

*〜Expected wOBA Value〜*

| 打球角度＼打球速度 | 〜95 | 95〜100 | 100〜105 | 105〜 |
|:---:|:---:|:---:|:---:|:---:|
| 32〜 | .239 | .505 | .675 | 1.429 |
| 8〜32 | .324 | .350 | .646 | .768 |
| 〜8 | .347 | .162 | .333 | .529 |

*〜Predictive wOBA Value〜*
*Predictive wOBA Valueの算出にはホークアイが導入され打球データの取りこぼしがほぼなくなった2020年以降でBBEが200以上の打者を対象*

予測的文脈においての xwOBAの問題点を補う形でPredictive wOBAの係数が設定されているかと思います。例えば、試合においては打球速度95〜100mphで打球角度32度以上の打球の価値は低いですが、その打球を打てる打者の価値は高いです（wOBAcon .500は2023年MLBで言うと2位相当）。

注目ポイントとしては所謂**Sweet Spot**と呼ばれる打球角度8度以上32以下の範囲でしょうか。wOBA .550を超えるような高い価値を持った打球角度としてSweet Spotという基準は作られましたが、**Sweet Spot%の年度間相関は0.596**なのに対して**Hard Hit%（打球速度95mph以上の割合）の年度間相関は0.840**です（2015〜2023、300打席以上）。この再現性の違いを考慮できることでPredictive wOBAは xwOBAより wOBAの予測力を高めています。

ちなみにPredictive wOBA考案者のトム・タンゴは最終的に8ビンまで減らしています。

| 打球角度＼打球速度 | 〜95 | 95〜100 | 100〜105 | 105〜 |
|:---:|:---:|:---:|:---:|:---:|
| 32〜 | .206 | .570 | | .838 |
| 8〜32 | | .383 | .606 | .867 |
| 〜8 | | .306 | | .577 |

*〜Predictive wOBA Value (Tango Ver.)〜*

これらの表でBarrel%が xwOBAconよりも wOBAconを予測できた理由が分かるかと思います。

Barrelはその閾値を wOBA .950付近（表向きには打率 .500、長打率 1.500）に設定した経緯としてよりシンプルなものに拘ったというポイントがあります。

![Barrelの閾値設定](/solving-baseball/images/75.png)

*http://tangotiger.com/index.php/site/comments/statcast-lab-barrels*

上記画像の白い部分も高 wOBAの範囲ですがそこを捨てています。これにより結果的に（ある程度は予想できていたと思いますが）信頼度が低い打球に引っ張られず、xwOBAconよりも wOBAconを僅かながら予測できています。

では、一応Predictive wOBAconの予測力を確認しておきましょう。

![翌年のwOBAconとの関係（pwOBAcon含む）](/solving-baseball/images/76.png)

*翌年の wOBAconとの関係*

wOBAcon（0.293）から xwOBAcon（0.380）ほどのジャンプアップではないですが、pwOBAcon（0.425）でも無視できないほどのジャンプアップは見せています。

例に出した2023年4月のチャップマンも xwOBAは .486でしたが、pwOBAは .410でした。

---

## xwOBAと何を見るか

では xwOBAの相方探しに戻ります。予測を目的としたときにExpectedとは評価がズレる打球がPredictive wOBAの係数によって把握できます。

その係数の差は以下のようになっています。

| 打球角度＼打球速度 | 〜95 | 95〜100 | 100〜105 | 105〜 |
|:---:|:---:|:---:|:---:|:---:|
| 32〜 | .176 | .303 | .006 | .009 |
| 8〜32 | -.158 | -.263 | -.289 | -.451 |
| 〜8 | .165 | -.157 | -.050 | .078 |

*Predictive wOBA Value − Expected wOBA Value*

先ほども述べたように打球角度8度から打球角度32度のSweet Spotは試合での価値の高さ（xwOBAにおいての影響度の高さ）の割には信頼度は高いとは言えません。Predictive wOBAはそのような**不安定な打球の平均への回帰で予測力を高めている**とも言えます。

今回の目的は xwOBAぐらい手軽にサイトで確認できて xwOBAに加えて見ることで wOBA予測に役立つ指標を探すことなので、やはり**Sweet Spot%**でしょうか。FanGraphsでは無理ですがBaseball Savantではすぐに見つけられるはずです。

では実際の予測力の変化を見ていきます。wOBA予測を検証するか wOBAcon予測を検証するか迷いましたが他の分析と繋げるためにも打球要素と非打球要素は切り分けておこうかなと思います。

まずは xwOBAconと pwOBAconの差を確認しておきます。

> **★ xwOBAcon ★**
> **係数 [p値]：** xwOBA 0.611 [2e-16]
> **切片 [p値]：** 0.139 [2e-16]
> **自由度調整済み決定係数：** 0.3792
> **標準誤差：** 0.04259
> **F統計量：** 327.2　p値 2.2e-16

> **★ pwOBAcon ★**
> **係数 [p値]：** pwOBAcon 0.984 [2e-16]
> **切片 [p値]：** -0.006 [0.765]
> **自由度調整済み決定係数：** 0.4244
> **標準誤差：** 0.04101
> **F統計量：** 394.7　p値 2.2e-16
>
> *pwOBAconが 0になることはありえないので切片のp値は問題ありません*

wOBAconを説明変数としたときの補正R²は0.291ですので xwOBAconで0.379への上昇は相当のものがあります。さらに pwOBAconでは0.424まで上昇しました。

xwOBAconの相方として目指すところは 0.379以上になるでしょう。

ではSweet Spot%を加えます。

Sweet Spot%もその信頼度が打球速度系に劣るという話であって打者によって高低の傾向は十分にあります。なのでそのままの数値ではなくキャリア通算との乖離、SwSp diff.を使います。

![Savantの個人ページ](/solving-baseball/images/77.png)

*savantの個人ページですぐに確認できます*

結果は以下です。

> **★ xwOBAcon & SwSp diff. ★**
> **係数 [p値]：** xwOBAcon 0.637 [2e-16]　SwSp diff. -0.244 [3.01e-07]
> **切片 [p値]：** 0.127 [2e-16]
> **自由度調整済み決定係数：** 0.4080
> **標準誤差：** 0.04159
> **F統計量：** 185.0　p値 2.2e-16
>
> *SwSp diff. は小数表記としています*

係数が負の値であるように自身の能力以上と推定されるSweet Spot%で向上させた xwOBAconは割り引いて考える必要がありそうです。補正R²も0.408とそこそこ向上しました。

チャップマンは22年までの通算Sweet Spot%が32.1%なのに対して、23年4月は42.5%でしたのでまさにその事例でした。

これ以外に有効的な指標は**Barrel%**です。先ほども述べたようにBarrelは信頼度が比較的高い打球に絞れています。つまり Barrel%も見るということは、xwOBAconの中でも信頼度の高い打球を加重するという話です。

結果は以下です。

> **★ xwOBAcon & Barrel% ★**
> **係数 [p値]：** xwOBAcon 0.269 [0.002]　Barrel% 0.475 [1.53e-05]
> **切片 [p値]：** 0.228 [2e-16]
> **自由度調整済み決定係数：** 0.3995
> **標準誤差：** 0.04189
> **F統計量：** 178.6　p値 2.2e-16

補正R²は xwOBAcon単体のみより向上させていて、モデル全体の統計的有意性も問題ありません。

ただ xwOBAconとBarrel%という関わりの強い変数間には共線性の問題が発生します。重回帰分析は説明変数が互いに独立していることを前提としており、似た情報を含んでいる変数にモデルが適切に係数を振り分けにくくなるということです。

xwOBAconとBarrel%のVIF（共線性を測る指標）は約 6.55でそこそこ危険な水準ではありますので、係数を直接解釈するのは避けたいところです。

ちなみにSweet Spot%と関わりの強いLD%やBABIPもキャリア通算との比較をすれば（能力と結果の乖離を推定すれば）xwOBAconを使った wOBAcon予測において追加的な情報を提供します。Sweet Spot%ほど予測力を高めなかったので結論としては**「xwOBAとSweet Spot%を見よう」**とさせていただきます。

---

## 文中紹介記事

- [Introducing Predictive wOBA](http://tangotiger.com/index.php/site/comments/introducing-predictive-woba) - Tangotiger Blog
- [Statcast Lab: Barrels](http://tangotiger.com/index.php/site/comments/statcast-lab-barrels) - Tangotiger Blog
